<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>寻找唐可可</title>
    <style>
      body {
        text-align: center;
        margin: 0;
      }
      div {
        display: inline-grid;
      }
      table {
        border-collapse: collapse;
      }
      tr {
        display: flex;
      }
      td{
        display: contents;
      }
    </style>
    <script>
      var time = 0, d, time_string;
      function show_bubu() {
        if (document.getElementById("result").style.display != "none")
          return;
        document.getElementById("bubu").style.display = "contents";
      }
      function start_timing() {
        d = new Date();
        time = d.getTime();
      }
      function finish() {
        d = new Date();
        if (document.getElementById("result").style.display != "none")
          return;
        time = d.getTime() - time;
        time = Math.floor(time / 10);
        time_string = time / 100;
        if (time % 100 == 0)
            time_string += ".00";
        else if (time % 10 == 0)
          time_string += "0";
        if (time <= 300) {
          document.getElementById("time").innerHTML = "恭喜你在三秒内找到了唐可可！用时" + time_string + "秒。";
        } else {
          //直接把整个table元素替换掉
          var res = document.getElementById("result");
          var h1 = document.createElement("h1");
          var text = document.createTextNode("恭喜你找到了唐可可！用时" + time_string + "秒。");
          var niubi = document.getElementById("niubi");
          h1.appendChild(text);
          res.replaceChild(h1, niubi);
        }
        document.getElementById("result").style.display = "contents";
        document.getElementById("bubu").style.display = "none";
      }
    </script>
  </head>
  <body>
    <div>
      <div id="result" style="display: none;">
        <table id="niubi" style="margin: 0 auto 1em auto;">
          <tr>
            <td><h1 id="time" style="line-height: 60px;"></h1></td>
            <td><img src="niubi.jpg" width="203" height="103"></td>
          </tr>
        </table>
        <button style="margin: 0 auto 0 auto; font-size: x-large;" onclick="location.reload()">再来一局</button>
        <a style="margin: 1em auto 1em auto;" href="https://github.com/plazum/find-keke" target="_blank">
          来GitHub上切克闹（指check it out）吧↗
        </a>
        <img style="margin: auto;" src="good_c5_q60.webp">
      </div>
      <div id="bubu" style="display: none;">
        <h1>不是这个哦，请再试一次。</h1>
        <img style="margin: auto;" src="bubu_c5_q60.webp">
      </div>
      <a href="debug" title="担心网络加载速度影响计时？点此前往测试加载速度" style="display: contents;" target="_blank">
        <div style="background-image: url(banner-extension.jpg);">
          <img style="margin: auto;" src="banner.jpg">
        </div>
      </a>
      <table style="margin: auto;">
        <script>
          var rows = 14;
          var cols = 14;
          var i, j, x, y;
          var board = new Array();
          x = Math.floor(Math.random() * rows);
          y = Math.floor(Math.random() * cols);
          for (i = 0; i < rows; i++) {
            board[i] = Array.from({length: cols}, v=> Math.floor(Math.random() * 2));
          }
          for (i = 0; i < rows; i++) {
            document.write("<tr>");
            for (j = 0; j < cols; j++) {
              document.write("<td>");
              if (i == x && j == y) {
                document.write('<img onclick="finish()" src="keke.jpg">');
              } else if (board[i][j] == 0) {
                document.write('<img onclick="show_bubu()" src="kotori.jpg">');
              } else if (board[i][j] == 1) {
                document.write('<img onclick="show_bubu()" src="you.jpg">');
              }
              document.write("</td>");
            }
            document.write("</tr>");
          }
          start_timing();
        </script>
      </table>
    </div>
  </body>
</html>
